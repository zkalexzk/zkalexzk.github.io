<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ†ç±»ç³»ç»Ÿæµ‹è¯•</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-case {
            background: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .test-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .result {
            padding: 10px;
            background: #f9fafb;
            border-radius: 4px;
            margin-top: 5px;
        }
        .success {
            color: #10b981;
        }
        .error {
            color: #ef4444;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª èŠ¯ç‰‡åˆ†ç±»ç³»ç»Ÿæµ‹è¯•</h1>
    <div id="test-results"></div>

    <script src="chip-classification.js"></script>
    <script src="chipid-parser.js"></script>
    <script>
        const testCases = [
            {
                name: "ES96æ—©æœŸå·¥ç¨‹èŠ¯ç‰‡ (U6B900 #4)",
                chipid: "553642393030040A14FF1E0000000000",
                expected: {
                    lot: "U6B900",
                    wafer: 4,
                    priority: "Super Hot Run",
                    status: "ES96æ—©æœŸå·¥ç¨‹èŠ¯ç‰‡",
                    description: "ä»…LBISTæµ‹è¯•ï¼Œè¦†ç›–ç‡70%"
                }
            },
            {
                name: "ES96æ—©æœŸå·¥ç¨‹èŠ¯ç‰‡ (U6B900 #6)",
                chipid: "553642393030060A14FF1E0000000000",
                expected: {
                    lot: "U6B900",
                    wafer: 6,
                    priority: "Super Hot Run",
                    status: "ES96æ—©æœŸå·¥ç¨‹èŠ¯ç‰‡",
                    description: "ä»…LBISTæµ‹è¯•ï¼Œè¦†ç›–ç‡70%"
                }
            },
            {
                name: "Golden wafer (U6B902 #1)",
                chipid: "553642393032010D14FF1E0000000000",
                expected: {
                    lot: "U6B902",
                    wafer: 1,
                    priority: "Hot Run",
                    status: "Golden wafer",
                    description: "å‚è€ƒwaferä¸å‡ºè´§"
                }
            },
            {
                name: "å¯é æ€§å®éªŒèŠ¯ç‰‡ (U6B901 #9)",
                chipid: "553642393031090914FF1E0000000000",
                expected: {
                    lot: "U6B901",
                    wafer: 9,
                    priority: "Hot Run",
                    status: "å¯é æ€§å®éªŒèŠ¯ç‰‡",
                    description: "ATEæµ‹è¯•ï¼Œè¦†ç›–ç‡90%"
                }
            },
            {
                name: "æ™®é€šé‡äº§èŠ¯ç‰‡ (U6B999 #10 - ä¸åœ¨æ•°æ®åº“ä¸­)",
                chipid: "5536423939390A0A14FF1E0000000000",
                expected: {
                    lot: "U6B999",
                    wafer: 10,
                    priority: "Normal Production",
                    status: "é‡äº§",
                    description: "æ­£å¸¸é‡äº§èŠ¯ç‰‡ï¼Œè¦†ç›–ç‡99+%"
                }
            }
        ];

        const resultsDiv = document.getElementById('test-results');

        // æµ‹è¯•ChipClassificationDBæ˜¯å¦å·²åŠ è½½
        const testDiv1 = document.createElement('div');
        testDiv1.className = 'test-case';
        testDiv1.innerHTML = `
            <div class="test-title">ç³»ç»Ÿæ£€æŸ¥</div>
            <div class="result">
                ChipClassificationDB å·²åŠ è½½: <span class="${typeof ChipClassificationDB !== 'undefined' ? 'success' : 'error'}">${typeof ChipClassificationDB !== 'undefined' ? 'âœ“ æ˜¯' : 'âœ— å¦'}</span><br>
                ChipIDParser å·²åŠ è½½: <span class="${typeof ChipIDParser !== 'undefined' ? 'success' : 'error'}">${typeof ChipIDParser !== 'undefined' ? 'âœ“ æ˜¯' : 'âœ— å¦'}</span><br>
                æ•°æ®åº“è®°å½•æ•°: ${typeof ChipClassificationDB !== 'undefined' ? ChipClassificationDB.data.length : 'N/A'}
            </div>
        `;
        resultsDiv.appendChild(testDiv1);

        // è¿è¡Œæµ‹è¯•ç”¨ä¾‹
        testCases.forEach((testCase, index) => {
            const testDiv = document.createElement('div');
            testDiv.className = 'test-case';

            let resultHTML = `<div class="test-title">æµ‹è¯• ${index + 1}: ${testCase.name}</div>`;
            resultHTML += `<div>CHIPID: ${testCase.chipid}</div>`;

            try {
                const result = ChipIDParser.parse(testCase.chipid);

                // æ£€æŸ¥æ¯ä¸ªå­—æ®µ
                const checks = {
                    'Lot ID': result.lot === testCase.expected.lot,
                    'Wafer': result.wafer === testCase.expected.wafer,
                    'Priority': result.priority === testCase.expected.priority,
                    'Status': result.status === testCase.expected.status,
                    'Description': result.description === testCase.expected.description
                };

                const allPassed = Object.values(checks).every(v => v);

                resultHTML += '<div class="result">';
                resultHTML += `<strong class="${allPassed ? 'success' : 'error'}">${allPassed ? 'âœ“ æµ‹è¯•é€šè¿‡' : 'âœ— æµ‹è¯•å¤±è´¥'}</strong><br><br>`;

                resultHTML += `æœŸæœ›å€¼:<br>`;
                resultHTML += `  Lot: ${testCase.expected.lot}<br>`;
                resultHTML += `  Wafer: ${testCase.expected.wafer}<br>`;
                resultHTML += `  Priority: ${testCase.expected.priority}<br>`;
                resultHTML += `  Status: ${testCase.expected.status}<br>`;
                resultHTML += `  Description: ${testCase.expected.description}<br><br>`;

                resultHTML += `å®é™…å€¼:<br>`;
                resultHTML += `  Lot: ${result.lot} <span class="${checks['Lot ID'] ? 'success' : 'error'}">${checks['Lot ID'] ? 'âœ“' : 'âœ—'}</span><br>`;
                resultHTML += `  Wafer: ${result.wafer} <span class="${checks['Wafer'] ? 'success' : 'error'}">${checks['Wafer'] ? 'âœ“' : 'âœ—'}</span><br>`;
                resultHTML += `  Priority: ${result.priority} <span class="${checks['Priority'] ? 'success' : 'error'}">${checks['Priority'] ? 'âœ“' : 'âœ—'}</span><br>`;
                resultHTML += `  Status: ${result.status} <span class="${checks['Status'] ? 'success' : 'error'}">${checks['Status'] ? 'âœ“' : 'âœ—'}</span><br>`;
                resultHTML += `  Description: ${result.description} <span class="${checks['Description'] ? 'success' : 'error'}">${checks['Description'] ? 'âœ“' : 'âœ—'}</span><br>`;
                resultHTML += `  ECID: ${result.ecid}<br>`;

                resultHTML += '</div>';

            } catch (error) {
                resultHTML += `<div class="result error">âœ— è§£æé”™è¯¯: ${error.message}</div>`;
            }

            testDiv.innerHTML = resultHTML;
            resultsDiv.appendChild(testDiv);
        });

        // æ€»ç»“
        const summaryDiv = document.createElement('div');
        summaryDiv.className = 'test-case';
        summaryDiv.style.borderColor = '#10b981';
        summaryDiv.innerHTML = `
            <div class="test-title">æµ‹è¯•å®Œæˆ</div>
            <div class="result">
                è¯·æ£€æŸ¥ä¸Šè¿°æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹çš„ç»“æœã€‚<br>
                å¦‚æœæ‰€æœ‰æµ‹è¯•éƒ½æ˜¾ç¤º <span class="success">âœ“ æµ‹è¯•é€šè¿‡</span>ï¼Œè¯´æ˜åˆ†ç±»ç³»ç»Ÿå·¥ä½œæ­£å¸¸ã€‚
            </div>
        `;
        resultsDiv.appendChild(summaryDiv);
    </script>
</body>
</html>
